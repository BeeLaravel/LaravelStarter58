## redis

### 使用场景
缓存
消息队列 数据一致性要求不高
计数器 原子性 避免并发
页面数据缓存
热点数据

### 特点
纯内存
单线程
数据结构简单 对数据的操作也比较简单
底层实现方式 客户端通信协议
多路 I/O 复用模型 非阻塞 I/O
事务
备份
持久化
修改数据后需将持久化硬盘数据重新加入内容中

#### 数据一致性
最终一致性 保证
强一致性 不能保证
#### 删除策略
定期删除 默认 100ms 随机检测
惰性删除
内存淘汰

#### 缓存击穿
定时任务 主动更新缓存
分级缓存
拦截机制 维护合法 key key 不合法时直接返回

#### 缓存雪崩
随机失效时间 避免同一时间集体失效
分级缓存 原始缓存失效从拷贝缓存读取
加锁 队列 避免过多请求同时对服务器读写

### 数据结构
#### String 字符串
#### Hash 哈希
结构化数据

在单个 Hash 元素不足一定数量时压缩存储

#### List 列表
双向链表 反向查找遍历
内部实现 发送缓冲队列
lrange 分页

#### Set 集合
类似 List + 自动排重

#### Sorted Set 有序集合
按照某个条件的权重排序

点击数排行榜

### 内存统计
used_memory 分配器分配的内存总量（字节）包括虚拟内存（swap） used_memory_human
used_memory_rss 进程占据操作系统的内存（字节）top|ps 一致 包括进程运行本身需要的内存、内存碎片等 不包括虚拟内存
mem_fragmentation_ratio 内存碎片比率 used_memory_rss / used_memory 对于 jemalloc 1.03 左右比较健康
mem_allocator 内存分配器 编译时指定 libc|jemalloc(default)|tcmalloc



AOF、RDB重写